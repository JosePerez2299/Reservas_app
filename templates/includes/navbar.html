{% load utils %}
{% load static %}

<!-- Navbar moderno con glassmorphism y animaciones -->
<div class="navbar bg-base-100/95 backdrop-blur-md shadow-lg border-b border-base-300/50 sticky top-0 ">
  <div class="navbar-start">
    <!-- Mobile menu button con animación -->
    <div class="dropdown lg:hidden">
      <div tabindex="0" role="button" class="btn btn-ghost btn-circle hover:bg-base-200 transition-all duration-200">
        <svg class="w-6 h-6 transition-transform duration-200 hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16"></path>
        </svg>
      </div>
      <ul tabindex="0" class="menu menu-sm dropdown-content mt-3 z-[1] p-3 shadow-xl bg-base-100/95 backdrop-blur-md rounded-xl w-64 border border-base-300/50">
        <!-- Header del menú móvil -->
        <li class="menu-title pb-2">
          <span class="text-base-content/70 font-semibold">Navegación</span>
        </li>
        
        {% for item in dashboard_access %}
        <li class="mb-1">
          <a href="{% url item.url %}" 
             class="flex items-center gap-3 p-3 rounded-lg transition-all duration-200 hover:bg-base-200 hover:scale-[1.02] group
                    {% if current_section|lower == item.label|lower %}bg-primary/10 text-primary border-l-4 border-primary{% endif %}">
            <span class="text-lg group-hover:scale-110 transition-transform duration-200">
              {% get_icon item.label|lower %}
            </span>
            <span class="font-medium">{{ item.label|capfirst }}</span>
          </a>
        </li>
        {% endfor %}
      </ul>
    </div>
    
    <!-- Logo y branding mejorado -->
    <div class="flex items-center gap-3 ml-2">
      <div class="flex items-center gap-3 p-2 rounded-lg hover:bg-base-200/50 transition-all duration-200">
        <div class="relative">
          <img src="{% static 'src/images/logo.svg' %}" alt="Logo" class="h-10 w-auto transition-transform duration-200 hover:scale-110">
          <div class="absolute -inset-1 bg-primary/20 rounded-full blur opacity-0 group-hover:opacity-100 transition-opacity duration-200"></div>
        </div>
        <div class="hidden sm:block">
          <div class="h-8 w-px bg-gradient-to-b from-transparent via-base-300 to-transparent"></div>
        </div>
        <div class="hidden sm:flex flex-col">
          <span class="font-bold text-primary text-lg leading-tight">{{user.grupo|capfirst}}</span>
          <span class="text-xs text-base-content/60 font-medium">Dashboard</span>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Navegación central con efectos hover mejorados -->
  <div class="navbar-center hidden lg:flex">
    <ul class="menu menu-horizontal gap-2">
      {% for item in dashboard_access %}
      <li>
        <a href="{% url item.url %}" 
           class="flex items-center gap-2 px-4 py-2 rounded-xl  transition-all duration-200 hover:scale-105 hover:shadow-md group
                  {% if current_section|lower == item.label|lower %}bg-primary font-medium text-primary-content shadow-lg scale-105{% else %}hover:bg-base-200{% endif %}">
          <span class="text-lg group-hover:scale-110 transition-transform duration-200">
            {% get_icon item.label|lower %}
          </span>
          <span>{{ item.label|capfirst }}</span>
          {% if current_section|lower == item.label|lower %}
          <div class="absolute -bottom-1 left-1/2 transform -translate-x-1/2 w-3 h-3 bg-info z-10 rounded-full animate-pulse"></div>
          {% endif %}
        </a>
      </li>
      {% endfor %}
    </ul>
  </div>
  
  <!-- Sección derecha con controles de usuario -->
  <div class="navbar-end">
    <div class="flex items-center gap-2">
      
     
      
      <!-- User dropdown mejorado -->
      <div class="dropdown dropdown-end">
        <div tabindex="0" role="button" class=" hover:bg-base-200 rounded-xl px-2 py-4 cursor-pointer  h-fit transition-all duration-200 hover:scale-105 hover:shadow-md">
        <div class="flex items-center gap-3">
        <div >
            <div class="bg-gradient-to-br from-primary to-primary-focus text-primary-content 
                        rounded-xl w-10 h-10 ring-2 ring-primary/20 ring-offset-2 ring-offset-base-100
                        flex items-center justify-center font-bold">
            <p>{{ user.username|slice:'0:2'|upper }}</p>
            </div>
        </div>
        <div class="hidden md:flex flex-col items-start">
            <span class="font-semibold text-sm leading-tight">
            {{ user.get_full_name|default:user.username }}
            </span>
            <span class="text-xs text-base-content/60">
            {{ user.email|truncatechars:20 }}
            </span>
        </div>
        <svg class="w-4 h-4 text-base-content/60 transition-transform duration-200 group-hover:rotate-180" 
            fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
        </svg>
        </div>

        </div>
        
        <ul tabindex="0" class="menu menu-sm dropdown-content mt-3 z-[1] p-3 shadow-xl bg-base-100/95 backdrop-blur-xs rounded-xl w-72 border border-base-300/50">
          <!-- Header del usuario -->
          <li class="menu-title pb-3 border-b border-base-300/50 mb-3">
            <div class="flex items-center gap-3">
              <div>
                <div class="bg-gradient-to-br flex justify-center items-center from-primary to-primary-focus text-primary-content rounded-lg w-12 h-12">
                  <span class="font-bold">{{user.username|slice:'0:2'|upper}}</span>
                </div>
              </div>
              <div>
                <p class="font-semibold text-base-content">{{ user.get_full_name|default:user.username }}</p>
                <p class="text-xs text-base-content/60">{{ user.email }}</p>
                <div class="flex items-center gap-1 mt-1">
                  <div class="w-2 h-2 bg-success rounded-full"></div>
                  <span class="text-xs text-success font-medium">Activo</span>
                </div>
              </div>
            </div>
          </li>
          
          <!-- Opciones del menú -->
          <li>
            <a href="{% url 'profile' %}" class="flex items-center gap-3 p-3 rounded-lg hover:bg-base-200 transition-all duration-200 group">
              <i class="fas fa-user-circle text-primary group-hover:scale-110 transition-transform duration-200"></i>
              <div>
                <span class="font-medium">Mi Perfil</span>
                <p class="text-xs text-base-content/60">Configurar cuenta</p>
              </div>
            </a>
          </li>
          
          <li>
            <a href="{% url 'log' %}" class="flex items-center gap-3 p-3 rounded-lg hover:bg-base-200 transition-all duration-200 group">
              <i class="fas fa-history text-info group-hover:scale-110 transition-transform duration-200"></i>
              <div>
                <span class="font-medium">Actividad</span>
                <p class="text-xs text-base-content/60">Historial reciente</p>
              </div>
            </a>
          </li>
          

          <div class="divider my-2"></div>
          
          <!-- Logout -->
          <li>
            <form method="post" action="{% url 'logout' %}" class="flex ">
              {% csrf_token %}
              <button type="submit" class="flex-1 btn btn-error btn-ghost">
                <i class="fas fa-sign-out-alt group-hover:scale-110 transition-transform duration-200"></i>
                <div>
                  <span class="font-medium">Cerrar Sesión</span>
                  <p class="text-xs opacity-60">Salir de la cuenta</p>
                </div>
              </button>

            </form>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

<!-- Barra de progreso opcional para navegación -->
<div class="w-full h-1 bg-base-300 relative overflow-hidden">
  <div class="absolute top-0 left-0 h-full bg-gradient-to-r from-primary to-secondary w-0 transition-all duration-300" id="nav-progress"></div>
</div>

<style>
/* Animaciones adicionales */
@keyframes slideIn {
  from { transform: translateX(-100%); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}

@keyframes fadeInUp {
  from { transform: translateY(10px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

.navbar {
  animation: fadeInUp 0.5s ease-out;
}

.menu li {
  animation: slideIn 0.3s ease-out;
}

.menu li:nth-child(2) { animation-delay: 0.1s; }
.menu li:nth-child(3) { animation-delay: 0.2s; }
.menu li:nth-child(4) { animation-delay: 0.3s; }

/* Hover effects */
.navbar a:hover {
  transform: translateY(-1px);
}

.dropdown-content {
  animation: fadeInUp 0.3s ease-out;
}

/* Responsive improvements */
@media (max-width: 768px) {
  .navbar {
    padding: 0.5rem 1rem;
  }
  
  .navbar-start .flex {
    gap: 0.5rem;
  }
}


</style>

<script>
// Efecto de progreso en navegación
document.addEventListener('DOMContentLoaded', function() {
  const progressBar = document.getElementById('nav-progress');
  const navLinks = document.querySelectorAll('.navbar a');
  
  navLinks.forEach(link => {
    link.addEventListener('click', function() {
      progressBar.style.width = '100%';
      setTimeout(() => {
        progressBar.style.width = '0%';
      }, 1000);
    });
  });
  
  // Efecto de scroll para el navbar
  let lastScroll = 0;
  const navbar = document.querySelector('.navbar');
  
  window.addEventListener('scroll', function() {
    const currentScroll = window.pageYOffset;
    
    if (currentScroll > lastScroll && currentScroll > 100) {
      navbar.style.transform = 'translateY(-100%)';
    } else {
      navbar.style.transform = 'translateY(0)';
    }
    
    lastScroll = currentScroll;
  });
});
</script>